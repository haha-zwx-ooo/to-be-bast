<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>volatile</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/to-be-bast/favicon.ico">
    <script>
      var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?928c7c5c1127ed68793a835c728ec9be";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
        </script>
    <meta name="description" content="zwx-haha个人技术文档">
    
    <link rel="preload" href="/to-be-bast/assets/css/0.styles.be698e14.css" as="style"><link rel="preload" href="/to-be-bast/assets/js/app.c3e67182.js" as="script"><link rel="preload" href="/to-be-bast/assets/js/2.a97ad3d5.js" as="script"><link rel="preload" href="/to-be-bast/assets/js/35.8b547770.js" as="script"><link rel="prefetch" href="/to-be-bast/assets/js/10.c5262efb.js"><link rel="prefetch" href="/to-be-bast/assets/js/11.c59ed9e2.js"><link rel="prefetch" href="/to-be-bast/assets/js/12.9f0a73c1.js"><link rel="prefetch" href="/to-be-bast/assets/js/13.17a058af.js"><link rel="prefetch" href="/to-be-bast/assets/js/14.db6b1266.js"><link rel="prefetch" href="/to-be-bast/assets/js/15.21e0cede.js"><link rel="prefetch" href="/to-be-bast/assets/js/16.430911cf.js"><link rel="prefetch" href="/to-be-bast/assets/js/17.658f2682.js"><link rel="prefetch" href="/to-be-bast/assets/js/18.bcaa61e8.js"><link rel="prefetch" href="/to-be-bast/assets/js/19.76f74703.js"><link rel="prefetch" href="/to-be-bast/assets/js/20.b2ef81e3.js"><link rel="prefetch" href="/to-be-bast/assets/js/21.3539e5c6.js"><link rel="prefetch" href="/to-be-bast/assets/js/22.45f1fd04.js"><link rel="prefetch" href="/to-be-bast/assets/js/23.f7057a81.js"><link rel="prefetch" href="/to-be-bast/assets/js/24.871f1c42.js"><link rel="prefetch" href="/to-be-bast/assets/js/25.9dbd80cb.js"><link rel="prefetch" href="/to-be-bast/assets/js/26.813bd17d.js"><link rel="prefetch" href="/to-be-bast/assets/js/27.77edb239.js"><link rel="prefetch" href="/to-be-bast/assets/js/28.3217d365.js"><link rel="prefetch" href="/to-be-bast/assets/js/29.2969c686.js"><link rel="prefetch" href="/to-be-bast/assets/js/3.0d77f0c3.js"><link rel="prefetch" href="/to-be-bast/assets/js/30.c1e77f7b.js"><link rel="prefetch" href="/to-be-bast/assets/js/31.a2723f65.js"><link rel="prefetch" href="/to-be-bast/assets/js/32.51203b3b.js"><link rel="prefetch" href="/to-be-bast/assets/js/33.39ad8118.js"><link rel="prefetch" href="/to-be-bast/assets/js/34.5ee668ce.js"><link rel="prefetch" href="/to-be-bast/assets/js/36.2acc3458.js"><link rel="prefetch" href="/to-be-bast/assets/js/37.077c6e56.js"><link rel="prefetch" href="/to-be-bast/assets/js/38.11563a61.js"><link rel="prefetch" href="/to-be-bast/assets/js/39.07d7a301.js"><link rel="prefetch" href="/to-be-bast/assets/js/4.d12742be.js"><link rel="prefetch" href="/to-be-bast/assets/js/40.30a9124a.js"><link rel="prefetch" href="/to-be-bast/assets/js/41.a2876b17.js"><link rel="prefetch" href="/to-be-bast/assets/js/42.67ec8031.js"><link rel="prefetch" href="/to-be-bast/assets/js/43.000c7c57.js"><link rel="prefetch" href="/to-be-bast/assets/js/44.ebcefafd.js"><link rel="prefetch" href="/to-be-bast/assets/js/45.c0542bf1.js"><link rel="prefetch" href="/to-be-bast/assets/js/46.885b14aa.js"><link rel="prefetch" href="/to-be-bast/assets/js/47.bad3ee03.js"><link rel="prefetch" href="/to-be-bast/assets/js/48.5cae63f1.js"><link rel="prefetch" href="/to-be-bast/assets/js/49.f7f0e9bd.js"><link rel="prefetch" href="/to-be-bast/assets/js/5.216cae74.js"><link rel="prefetch" href="/to-be-bast/assets/js/50.0f8dfcf4.js"><link rel="prefetch" href="/to-be-bast/assets/js/51.2c964dc0.js"><link rel="prefetch" href="/to-be-bast/assets/js/52.e12923d4.js"><link rel="prefetch" href="/to-be-bast/assets/js/53.8e58b6aa.js"><link rel="prefetch" href="/to-be-bast/assets/js/54.9c0c208f.js"><link rel="prefetch" href="/to-be-bast/assets/js/55.0d700812.js"><link rel="prefetch" href="/to-be-bast/assets/js/56.3c84f5d6.js"><link rel="prefetch" href="/to-be-bast/assets/js/57.3813517d.js"><link rel="prefetch" href="/to-be-bast/assets/js/58.d2454e98.js"><link rel="prefetch" href="/to-be-bast/assets/js/59.00a0b442.js"><link rel="prefetch" href="/to-be-bast/assets/js/6.2d0a63f8.js"><link rel="prefetch" href="/to-be-bast/assets/js/60.dc71c357.js"><link rel="prefetch" href="/to-be-bast/assets/js/61.243b7158.js"><link rel="prefetch" href="/to-be-bast/assets/js/62.ed7cb8b4.js"><link rel="prefetch" href="/to-be-bast/assets/js/63.e40f2c54.js"><link rel="prefetch" href="/to-be-bast/assets/js/64.84f845fd.js"><link rel="prefetch" href="/to-be-bast/assets/js/65.0cea4cc9.js"><link rel="prefetch" href="/to-be-bast/assets/js/66.2d776da3.js"><link rel="prefetch" href="/to-be-bast/assets/js/67.eeaa7ab3.js"><link rel="prefetch" href="/to-be-bast/assets/js/68.bb2e319b.js"><link rel="prefetch" href="/to-be-bast/assets/js/69.5363dc47.js"><link rel="prefetch" href="/to-be-bast/assets/js/7.2f0859e3.js"><link rel="prefetch" href="/to-be-bast/assets/js/70.f5829a44.js"><link rel="prefetch" href="/to-be-bast/assets/js/71.3226e5b5.js"><link rel="prefetch" href="/to-be-bast/assets/js/72.4bc7c7a3.js"><link rel="prefetch" href="/to-be-bast/assets/js/73.4f01d8fc.js"><link rel="prefetch" href="/to-be-bast/assets/js/74.455ffd32.js"><link rel="prefetch" href="/to-be-bast/assets/js/75.adbb6e85.js"><link rel="prefetch" href="/to-be-bast/assets/js/76.8aeea110.js"><link rel="prefetch" href="/to-be-bast/assets/js/77.f4e5bcff.js"><link rel="prefetch" href="/to-be-bast/assets/js/78.0eb64265.js"><link rel="prefetch" href="/to-be-bast/assets/js/79.2155f6c9.js"><link rel="prefetch" href="/to-be-bast/assets/js/8.28816398.js"><link rel="prefetch" href="/to-be-bast/assets/js/9.c31128b6.js">
    <link rel="stylesheet" href="/to-be-bast/assets/css/0.styles.be698e14.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/to-be-bast/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/to-be-bast/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="你皮05的 Java 博客" class="dropdown-title"><span class="title">你皮05的 Java 博客</span> <span class="arrow down"></span></button> <button type="button" aria-label="你皮05的 Java 博客" class="mobile-dropdown-title"><span class="title">你皮05的 Java 博客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/haha-zwx-ooo" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/to-be-bast/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="你皮05的 Java 博客" class="dropdown-title"><span class="title">你皮05的 Java 博客</span> <span class="arrow down"></span></button> <button type="button" aria-label="你皮05的 Java 博客" class="mobile-dropdown-title"><span class="title">你皮05的 Java 博客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/haha-zwx-ooo" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/to-be-bast/" aria-current="page" class="sidebar-link">职业技能</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/to-be-bast/basic/Java数据类型" class="sidebar-heading clickable"><span>Java基础知识</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/to-be-bast/core/多线程一" class="sidebar-heading clickable open"><span>Java核心技术</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/to-be-bast/core/多线程一.html" class="sidebar-link">多线程概念</a></li><li><a href="/to-be-bast/core/多线程二.html" class="sidebar-link">多线程使用</a></li><li><a href="/to-be-bast/core/多线程三.html" class="sidebar-link">线程返回值和异常</a></li><li><a href="/to-be-bast/core/多线程四.html" class="sidebar-link">线程池</a></li><li><a href="/to-be-bast/core/多线程五.html" class="sidebar-link">自定义线程池</a></li><li><a href="/to-be-bast/core/多线程六.html" class="sidebar-link">线程池使用案例</a></li><li><a href="/to-be-bast/core/多线程七.html" class="sidebar-link">上下文传递</a></li><li><a href="/to-be-bast/core/线程安全1.html" class="sidebar-link">线程安全</a></li><li><a href="/to-be-bast/core/线程安全2.html" class="active sidebar-link">volatile</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/to-be-bast/core/线程安全2.html#指令重排序" class="sidebar-link">指令重排序</a></li><li class="sidebar-sub-header"><a href="/to-be-bast/core/线程安全2.html#happens-before" class="sidebar-link">happens-before</a></li><li class="sidebar-sub-header"><a href="/to-be-bast/core/线程安全2.html#线程私有和共享内存" class="sidebar-link">线程私有和共享内存</a></li><li class="sidebar-sub-header"><a href="/to-be-bast/core/线程安全2.html#volatile-原理" class="sidebar-link">volatile 原理</a></li><li class="sidebar-sub-header"><a href="/to-be-bast/core/线程安全2.html#内存屏障" class="sidebar-link">内存屏障</a></li><li class="sidebar-sub-header"><a href="/to-be-bast/core/线程安全2.html#案例" class="sidebar-link">案例</a></li></ul></li><li><a href="/to-be-bast/core/线程安全3.html" class="sidebar-link">synchronized</a></li><li><a href="/to-be-bast/core/线程安全4.html" class="sidebar-link">ReentrantLock</a></li><li><a href="/to-be-bast/core/线程安全5.html" class="sidebar-link">AQS</a></li><li><a href="/to-be-bast/core/线程安全6.html" class="sidebar-link">读写锁</a></li><li><a href="/to-be-bast/core/线程安全7.html" class="sidebar-link">写时复制(Copy-On-Write)</a></li><li><a href="/to-be-bast/core/集合框架.html" class="sidebar-link">集合</a></li><li><a href="/to-be-bast/core/IO流.html" class="sidebar-link">IO</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/to-be-bast/web/servlet" class="sidebar-heading clickable"><span>JavaWeb</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/to-be-bast/db/db" class="sidebar-heading clickable"><span>数据库</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/to-be-bast/designpattern/designpattern" class="sidebar-heading clickable"><span>设计模式</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/to-be-bast/frame/frame" class="sidebar-heading clickable"><span>框架和工具</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/to-be-bast/cache/cache" class="sidebar-heading clickable"><span>缓存</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/to-be-bast/mq/mq" class="sidebar-heading clickable"><span>消息队列</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/to-be-bast/lock/lock" class="sidebar-heading clickable"><span>分布式锁</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/to-be-bast/tr/tr" class="sidebar-heading clickable"><span>分布式事务</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="volatile"><a href="#volatile" class="header-anchor">#</a> volatile</h1> <p>volatile 是 Java 中的一个关键字，用来修饰变量。使用 volatile 关键字修饰的变量可以保证线程之间的可见性，即一个线程修改了该变量的值，其他线程能够立即看到这个修改。</p> <p>具体来说，当一个变量被声明为 volatile 后，编译器和 JVM 会注意到这个变量是共享的，不会将该变量上的操作与其他内存操作一起进行重排序，保证该变量的读写顺序与程序中的执行顺序一致。</p> <p>通常情况下，线程从自己的工作内存中读取变量的值，如果该变量被多个线程共享，那么就可能存在一个线程修改了该变量的值，但其他线程并不能立即看到这个修改，从而导致线程安全问题。使用
volatile 关键字修饰变量能够解决这个问题。</p> <p>需要注意的是，volatile 关键字并不能保证原子性，即多个线程同时对一个 volatile 变量进行读写操作时，仍然可能会发生竞争条件</p> <h2 id="指令重排序"><a href="#指令重排序" class="header-anchor">#</a> 指令重排序</h2> <p>指令重排序是指在不改变程序执行结果的前提下，将指令的执行顺序进行重新排序。在现代处理器中，为了提高执行效率，处理器可能会对输入的代码进行乱序执行，从而提高指令级别的并行度。指令重排序在处理器层面上实现，对程序员是透明的。</p> <p>然而，指令重排序在多线程程序中可能会导致意外的行为，比如程序的执行结果与预期不符，因为重排序可能会破坏原本程序代码中的依赖关系，从而导致程序出现数据竞争、死锁等问题。因此，在多线程程序中，我们需要使用同步机制（比如锁、volatile关键字等）来避免指令重排序带来的问题。</p> <p>在执行程序时为了提高性能，编译器和处理器常常会对指令做重排序。重排序分三种类型：</p> <ol><li>编译器优化的重排序。编译器在不改变单线程程序语义的前提下，可以重新安排语句的执行顺序。</li> <li>指令级并行的重排序。现代处理器采用了指令级并行技术（Instruction-Level Parallelism，
ILP）来将多条指令重叠执行。如果不存在数据依赖性，处理器可以改变语句对应机器指令的执行顺序。</li> <li>内存系统的重排序。由于处理器使用缓存和读 / 写缓冲区，这使得加载和存储操作看上去可能是在乱序执行。</li></ol> <p><img src="/to-be-bast/images/%E6%8C%87%E4%BB%A4%E9%87%8D%E6%8E%92%E5%BA%8F.png" alt="指令重排序"></p> <h2 id="happens-before"><a href="#happens-before" class="header-anchor">#</a> happens-before</h2> <p>从 JDK5 开始，java 内存模型提出了 happens-before 的概念，通过这个概念来阐述操作之间的内存可见性。</p> <p>如果一个操作执行的结果需要对另一个操作可见，那么这两个操作之间必须存在 happens-before
关系。这里提到的两个操作既可以是在一个线程之内，也可以是在不同线程之间。</p> <p>这里的“可见性”是指当一条线程修改了这个变量的值，新值对于其他线程来说是可以立即得知的。</p> <p>如果 A happens-before B，那么 Java 内存模型将向程序员保证—— A 操作的结果将对 B 可见，且 A 的执行顺序排在 B 之前。</p> <p>重要的 happens-before 规则如下：</p> <ol><li>程序顺序规则：一个线程中的每个操作，happens- before 于该线程中的任意后续操作。</li> <li>监视器锁规则：对一个监视器锁的解锁，happens- before 于随后对这个监视器锁的加锁。</li> <li>volatile 变量规则：对一个 volatile 域的写，happens- before 于任意后续对这个 volatile 域的读。</li> <li>传递性：如果 A happens- before B，且 B happens- before C，那么 A happens- before C。</li></ol> <p>下图是 happens-before 与 JMM 的关系
<img src="/to-be-bast/images/happens-before.png" alt="happens-before"></p> <h2 id="线程私有和共享内存"><a href="#线程私有和共享内存" class="header-anchor">#</a> 线程私有和共享内存</h2> <ul><li>从JVM 角度来看</li></ul> <p><img src="/to-be-bast/images/jvm%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B.png" alt="jvm内存模型"> <img src="/to-be-bast/images/jvm%E5%86%85%E5%AD%98%E7%BA%BF%E7%A8%8B%E7%A7%81%E6%9C%89%E5%92%8C%E5%85%B1%E4%BA%AB.png" alt="jvm内存线程私有和共享"> <img src="/to-be-bast/images/%E7%BA%BF%E7%A8%8B%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B.png" alt="线程执行过程"></p> <ul><li>从cpu架构来看</li></ul> <p><img src="/to-be-bast/images/cpu%E5%92%8C%E5%86%85%E5%AD%98%E6%95%B0%E6%8D%AE%E4%B8%80%E8%87%B4%E6%80%A7.png" alt="cpu和内存数据一致性"></p> <p>由上述内容可以看出,不论jvm内存模型还是cpu执行架构,都存在线程共享数据区和线程私有数据区.因为有2块数据区,且线程私有
数据区相互隔离,所以存在数据不一致现象,也可以认为多级缓存架构下的数据不一致性问题</p> <h2 id="volatile-原理"><a href="#volatile-原理" class="header-anchor">#</a> volatile 原理</h2> <p>在Java中，使用volatile关键字修饰的变量可以保证可见性和有序性。可见性表示一个线程修改了共享变量的值，另一个线程能够立即看到修改后的值；有序性表示对共享变量的读写操作会按照一定的顺序执行，而不会因为指令重排序的优化而导致执行顺序混乱。</p> <p>volatile关键字的原理是通过禁止指令重排序和使用内存屏障的方式来实现可见性和有序性。</p> <p>具体来说，volatile关键字会强制将修改过的共享变量立即写回主存中，并清空工作内存中该变量的缓存行。同时，为了防止指令重排序，JVM会在写volatile变量之前插入一个StoreStore屏障，以防止之前的写指令重排到volatile写之后。在读volatile变量之后，JVM会插入一个LoadLoad屏障和一个LoadStore屏障，以防止之后的读指令重排到volatile读之前。</p> <p>由于volatile关键字会禁止指令重排序，因此会影响程序的执行效率。所以，只有在需要保证可见性和有序性的场景下才应该使用volatile关键字。</p> <h2 id="内存屏障"><a href="#内存屏障" class="header-anchor">#</a> 内存屏障</h2> <p>内存屏障（Memory Barrier），也叫内存栅栏，是一类特殊的CPU指令或者代码编译器指令，用于控制指令执行顺序以及保证内存可见性。</p> <p>内存屏障主要有以下三种类型：</p> <ol><li><p>Load Barrier：确保该指令之前的所有load指令都已经执行完毕，保证load指令的顺序性；</p></li> <li><p>Store Barrier：确保该指令之前的所有store指令都已经执行完毕，保证store指令的顺序性；</p></li> <li><p>Full Barrier：确保该指令之前的所有load和store指令都已经执行完毕，保证顺序性和内存可见性。</p></li></ol> <p>在Java内存模型中，volatile关键字就是通过插入内存屏障来实现线程之间的通信和保证可见性的。当一个变量被声明为volatile时，JVM会插入Load
Barrier和Store Barrier指令，保证了在执行这些指令之前和之后的其他指令都不能被重排序到其前面或者后面，从而保证了变量的可见性和顺序性。</p> <h2 id="案例"><a href="#案例" class="header-anchor">#</a> 案例</h2> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">VolatileDemo</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread1</span> t1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t1<span class="token punctuation">.</span><span class="token function">setFlag</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token class-name">Thread2</span> t2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t2<span class="token punctuation">.</span><span class="token function">setFlag_</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Data</span>
<span class="token keyword">class</span> <span class="token class-name">Thread1</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">private</span> <span class="token keyword">volatile</span> <span class="token keyword">boolean</span> flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Thread1 线程终止&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Data</span>
<span class="token keyword">class</span> <span class="token class-name">Thread2</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">private</span> <span class="token keyword">boolean</span> flag_ <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>flag_<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Thread2 线程终止&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>通过flag 和 flag_ 来控制线程停止,其中 flag 是volatile修饰的,有跨线程可见性,而flag_则是普通私有变量
预期结果是,t1正常停止且输出Thread1 线程终止,t2则继续运行</p> <div class="language-text extra-class"><pre class="language-text"><code>D:\Java\jdk1.8.0_361\bin\java.exe &quot;-javaagent:D:\JetBrains\IntelliJ IDEA 2023.1\lib\idea_rt.jar=63246:D:\JetBrains\IntelliJ IDEA 2023.1\bin&quot; -Dfile.encoding=UTF-8 -classpath D:\Java\jdk1.8.0_361\jre\lib\charsets.jar;D:\Java\jdk1.8.0_361\jre\lib\deploy.jar;D:\Java\jdk1.8.0_361\jre\lib\ext\access-bridge-64.jar;D:\Java\jdk1.8.0_361\jre\lib\ext\cldrdata.jar;D:\Java\jdk1.8.0_361\jre\lib\ext\dnsns.jar;D:\Java\jdk1.8.0_361\jre\lib\ext\jaccess.jar;D:\Java\jdk1.8.0_361\jre\lib\ext\jfxrt.jar;D:\Java\jdk1.8.0_361\jre\lib\ext\localedata.jar;D:\Java\jdk1.8.0_361\jre\lib\ext\nashorn.jar;D:\Java\jdk1.8.0_361\jre\lib\ext\sunec.jar;D:\Java\jdk1.8.0_361\jre\lib\ext\sunjce_provider.jar;D:\Java\jdk1.8.0_361\jre\lib\ext\sunmscapi.jar;D:\Java\jdk1.8.0_361\jre\lib\ext\sunpkcs11.jar;D:\Java\jdk1.8.0_361\jre\lib\ext\zipfs.jar;D:\Java\jdk1.8.0_361\jre\lib\javaws.jar;D:\Java\jdk1.8.0_361\jre\lib\jce.jar;D:\Java\jdk1.8.0_361\jre\lib\jfr.jar;D:\Java\jdk1.8.0_361\jre\lib\jfxswt.jar;D:\Java\jdk1.8.0_361\jre\lib\jsse.jar;D:\Java\jdk1.8.0_361\jre\lib\management-agent.jar;D:\Java\jdk1.8.0_361\jre\lib\plugin.jar;D:\Java\jdk1.8.0_361\jre\lib\resources.jar;D:\Java\jdk1.8.0_361\jre\lib\rt.jar;D:\java-workspaces\github\to-be-bast-one\java-core\target\classes;D:\maven-repo\com\alibaba\transmittable-thread-local\2.14.2\transmittable-thread-local-2.14.2.jar;D:\maven-repo\org\springframework\boot\spring-boot-starter-actuator\2.1.10.RELEASE\spring-boot-starter-actuator-2.1.10.RELEASE.jar;D:\maven-repo\org\springframework\boot\spring-boot-starter\2.1.10.RELEASE\spring-boot-starter-2.1.10.RELEASE.jar;D:\maven-repo\org\springframework\boot\spring-boot-starter-logging\2.1.10.RELEASE\spring-boot-starter-logging-2.1.10.RELEASE.jar;D:\maven-repo\ch\qos\logback\logback-classic\1.2.3\logback-classic-1.2.3.jar;D:\maven-repo\ch\qos\logback\logback-core\1.2.3\logback-core-1.2.3.jar;D:\maven-repo\org\apache\logging\log4j\log4j-to-slf4j\2.11.2\log4j-to-slf4j-2.11.2.jar;D:\maven-repo\org\apache\logging\log4j\log4j-api\2.11.2\log4j-api-2.11.2.jar;D:\maven-repo\org\slf4j\jul-to-slf4j\1.7.29\jul-to-slf4j-1.7.29.jar;D:\maven-repo\javax\annotation\javax.annotation-api\1.3.2\javax.annotation-api-1.3.2.jar;D:\maven-repo\org\yaml\snakeyaml\1.23\snakeyaml-1.23.jar;D:\maven-repo\org\springframework\boot\spring-boot-actuator-autoconfigure\2.1.10.RELEASE\spring-boot-actuator-autoconfigure-2.1.10.RELEASE.jar;D:\maven-repo\org\springframework\boot\spring-boot-actuator\2.1.10.RELEASE\spring-boot-actuator-2.1.10.RELEASE.jar;D:\maven-repo\com\fasterxml\jackson\core\jackson-databind\2.9.10.1\jackson-databind-2.9.10.1.jar;D:\maven-repo\com\fasterxml\jackson\core\jackson-annotations\2.9.10\jackson-annotations-2.9.10.jar;D:\maven-repo\org\springframework\spring-context\5.1.11.RELEASE\spring-context-5.1.11.RELEASE.jar;D:\maven-repo\org\springframework\spring-aop\5.1.11.RELEASE\spring-aop-5.1.11.RELEASE.jar;D:\maven-repo\org\springframework\spring-beans\5.1.11.RELEASE\spring-beans-5.1.11.RELEASE.jar;D:\maven-repo\org\springframework\spring-expression\5.1.11.RELEASE\spring-expression-5.1.11.RELEASE.jar;D:\maven-repo\com\fasterxml\jackson\datatype\jackson-datatype-jsr310\2.9.10\jackson-datatype-jsr310-2.9.10.jar;D:\maven-repo\io\micrometer\micrometer-core\1.1.8\micrometer-core-1.1.8.jar;D:\maven-repo\org\hdrhistogram\HdrHistogram\2.1.9\HdrHistogram-2.1.9.jar;D:\maven-repo\org\latencyutils\LatencyUtils\2.0.3\LatencyUtils-2.0.3.jar;D:\maven-repo\com\alibaba\cloud\spring-cloud-alibaba-nacos-discovery\2.1.0.RELEASE\spring-cloud-alibaba-nacos-discovery-2.1.0.RELEASE.jar;D:\maven-repo\com\alibaba\nacos\nacos-client\1.1.1\nacos-client-1.1.1.jar;D:\maven-repo\com\alibaba\nacos\nacos-common\1.1.1\nacos-common-1.1.1.jar;D:\maven-repo\commons-io\commons-io\2.2\commons-io-2.2.jar;D:\maven-repo\org\apache\commons\commons-lang3\3.8.1\commons-lang3-3.8.1.jar;D:\maven-repo\com\alibaba\nacos\nacos-api\1.1.1\nacos-api-1.1.1.jar;D:\maven-repo\com\alibaba\fastjson\1.2.47\fastjson-1.2.47.jar;D:\maven-repo\com\google\guava\guava\19.0\guava-19.0.jar;D:\maven-repo\commons-codec\commons-codec\1.11\commons-codec-1.11.jar;D:\maven-repo\com\fasterxml\jackson\core\jackson-core\2.9.10\jackson-core-2.9.10.jar;D:\maven-repo\io\prometheus\simpleclient\0.5.0\simpleclient-0.5.0.jar;D:\maven-repo\org\springframework\cloud\spring-cloud-commons\2.1.0.RELEASE\spring-cloud-commons-2.1.0.RELEASE.jar;D:\maven-repo\org\springframework\security\spring-security-crypto\5.1.7.RELEASE\spring-security-crypto-5.1.7.RELEASE.jar;D:\maven-repo\org\springframework\cloud\spring-cloud-context\2.1.0.RELEASE\spring-cloud-context-2.1.0.RELEASE.jar;D:\maven-repo\org\springframework\cloud\spring-cloud-starter-netflix-ribbon\2.1.0.RELEASE\spring-cloud-starter-netflix-ribbon-2.1.0.RELEASE.jar;D:\maven-repo\org\springframework\cloud\spring-cloud-starter\2.1.0.RELEASE\spring-cloud-starter-2.1.0.RELEASE.jar;D:\maven-repo\org\springframework\security\spring-security-rsa\1.0.7.RELEASE\spring-security-rsa-1.0.7.RELEASE.jar;D:\maven-repo\org\bouncycastle\bcpkix-jdk15on\1.60\bcpkix-jdk15on-1.60.jar;D:\maven-repo\org\bouncycastle\bcprov-jdk15on\1.60\bcprov-jdk15on-1.60.jar;D:\maven-repo\org\springframework\cloud\spring-cloud-netflix-ribbon\2.1.0.RELEASE\spring-cloud-netflix-ribbon-2.1.0.RELEASE.jar;D:\maven-repo\org\springframework\cloud\spring-cloud-netflix-archaius\2.1.0.RELEASE\spring-cloud-netflix-archaius-2.1.0.RELEASE.jar;D:\maven-repo\org\springframework\cloud\spring-cloud-starter-netflix-archaius\2.1.0.RELEASE\spring-cloud-starter-netflix-archaius-2.1.0.RELEASE.jar;D:\maven-repo\com\netflix\archaius\archaius-core\0.7.6\archaius-core-0.7.6.jar;D:\maven-repo\com\google\code\findbugs\jsr305\3.0.1\jsr305-3.0.1.jar;D:\maven-repo\commons-configuration\commons-configuration\1.8\commons-configuration-1.8.jar;D:\maven-repo\com\netflix\ribbon\ribbon\2.3.0\ribbon-2.3.0.jar;D:\maven-repo\com\netflix\ribbon\ribbon-transport\2.3.0\ribbon-transport-2.3.0.jar;D:\maven-repo\io\reactivex\rxnetty-contexts\0.4.9\rxnetty-contexts-0.4.9.jar;D:\maven-repo\io\reactivex\rxnetty-servo\0.4.9\rxnetty-servo-0.4.9.jar;D:\maven-repo\com\netflix\hystrix\hystrix-core\1.5.18\hystrix-core-1.5.18.jar;D:\maven-repo\javax\inject\javax.inject\1\javax.inject-1.jar;D:\maven-repo\io\reactivex\rxnetty\0.4.9\rxnetty-0.4.9.jar;D:\maven-repo\com\netflix\ribbon\ribbon-core\2.3.0\ribbon-core-2.3.0.jar;D:\maven-repo\commons-lang\commons-lang\2.6\commons-lang-2.6.jar;D:\maven-repo\com\netflix\ribbon\ribbon-httpclient\2.3.0\ribbon-httpclient-2.3.0.jar;D:\maven-repo\commons-collections\commons-collections\3.2.2\commons-collections-3.2.2.jar;D:\maven-repo\org\apache\httpcomponents\httpclient\4.5.10\httpclient-4.5.10.jar;D:\maven-repo\org\apache\httpcomponents\httpcore\4.4.12\httpcore-4.4.12.jar;D:\maven-repo\com\sun\jersey\jersey-client\1.19.1\jersey-client-1.19.1.jar;D:\maven-repo\com\sun\jersey\jersey-core\1.19.1\jersey-core-1.19.1.jar;D:\maven-repo\javax\ws\rs\jsr311-api\1.1.1\jsr311-api-1.1.1.jar;D:\maven-repo\com\sun\jersey\contribs\jersey-apache-client4\1.19.1\jersey-apache-client4-1.19.1.jar;D:\maven-repo\com\netflix\servo\servo-core\0.12.21\servo-core-0.12.21.jar;D:\maven-repo\com\netflix\netflix-commons\netflix-commons-util\0.3.0\netflix-commons-util-0.3.0.jar;D:\maven-repo\com\netflix\ribbon\ribbon-loadbalancer\2.3.0\ribbon-loadbalancer-2.3.0.jar;D:\maven-repo\com\netflix\netflix-commons\netflix-statistics\0.1.1\netflix-statistics-0.1.1.jar;D:\maven-repo\io\reactivex\rxjava\1.3.8\rxjava-1.3.8.jar;D:\maven-repo\com\alibaba\cloud\spring-cloud-alibaba-nacos-config\2.1.0.RELEASE\spring-cloud-alibaba-nacos-config-2.1.0.RELEASE.jar;D:\maven-repo\com\alibaba\cloud\spring-cloud-starter-alibaba-sentinel\2.1.0.RELEASE\spring-cloud-starter-alibaba-sentinel-2.1.0.RELEASE.jar;D:\maven-repo\com\alibaba\cloud\spring-cloud-alibaba-sentinel\2.1.0.RELEASE\spring-cloud-alibaba-sentinel-2.1.0.RELEASE.jar;D:\maven-repo\com\alibaba\csp\sentinel-transport-simple-http\1.6.3\sentinel-transport-simple-http-1.6.3.jar;D:\maven-repo\com\alibaba\csp\sentinel-transport-common\1.6.3\sentinel-transport-common-1.6.3.jar;D:\maven-repo\com\alibaba\csp\sentinel-datasource-extension\1.6.3\sentinel-datasource-extension-1.6.3.jar;D:\maven-repo\com\alibaba\csp\sentinel-annotation-aspectj\1.6.3\sentinel-annotation-aspectj-1.6.3.jar;D:\maven-repo\com\alibaba\csp\sentinel-core\1.6.3\sentinel-core-1.6.3.jar;D:\maven-repo\org\aspectj\aspectjrt\1.9.4\aspectjrt-1.9.4.jar;D:\maven-repo\org\aspectj\aspectjweaver\1.9.4\aspectjweaver-1.9.4.jar;D:\maven-repo\com\alibaba\csp\sentinel-web-servlet\1.6.3\sentinel-web-servlet-1.6.3.jar;D:\maven-repo\com\alibaba\csp\sentinel-spring-webflux-adapter\1.6.3\sentinel-spring-webflux-adapter-1.6.3.jar;D:\maven-repo\com\alibaba\csp\sentinel-reactor-adapter\1.6.3\sentinel-reactor-adapter-1.6.3.jar;D:\maven-repo\com\alibaba\csp\sentinel-parameter-flow-control\1.6.3\sentinel-parameter-flow-control-1.6.3.jar;D:\maven-repo\com\googlecode\concurrentlinkedhashmap\concurrentlinkedhashmap-lru\1.4.2\concurrentlinkedhashmap-lru-1.4.2.jar;D:\maven-repo\com\alibaba\csp\sentinel-cluster-server-default\1.6.3\sentinel-cluster-server-default-1.6.3.jar;D:\maven-repo\com\alibaba\csp\sentinel-cluster-common-default\1.6.3\sentinel-cluster-common-default-1.6.3.jar;D:\maven-repo\io\netty\netty-handler\4.1.43.Final\netty-handler-4.1.43.Final.jar;D:\maven-repo\io\netty\netty-common\4.1.43.Final\netty-common-4.1.43.Final.jar;D:\maven-repo\io\netty\netty-buffer\4.1.43.Final\netty-buffer-4.1.43.Final.jar;D:\maven-repo\io\netty\netty-transport\4.1.43.Final\netty-transport-4.1.43.Final.jar;D:\maven-repo\io\netty\netty-resolver\4.1.43.Final\netty-resolver-4.1.43.Final.jar;D:\maven-repo\io\netty\netty-codec\4.1.43.Final\netty-codec-4.1.43.Final.jar;D:\maven-repo\com\alibaba\csp\sentinel-cluster-client-default\1.6.3\sentinel-cluster-client-default-1.6.3.jar;D:\maven-repo\com\alibaba\cloud\spring-cloud-alibaba-sentinel-datasource\2.1.0.RELEASE\spring-cloud-alibaba-sentinel-datasource-2.1.0.RELEASE.jar;D:\maven-repo\org\springframework\boot\spring-boot-starter-aop\2.1.10.RELEASE\spring-boot-starter-aop-2.1.10.RELEASE.jar;D:\maven-repo\org\springframework\cloud\spring-cloud-starter-zipkin\2.1.0.RELEASE\spring-cloud-starter-zipkin-2.1.0.RELEASE.jar;D:\maven-repo\org\springframework\cloud\spring-cloud-starter-sleuth\2.1.0.RELEASE\spring-cloud-starter-sleuth-2.1.0.RELEASE.jar;D:\maven-repo\org\springframework\cloud\spring-cloud-sleuth-core\2.1.0.RELEASE\spring-cloud-sleuth-core-2.1.0.RELEASE.jar;D:\maven-repo\io\zipkin\brave\brave\5.6.1\brave-5.6.1.jar;D:\maven-repo\io\zipkin\brave\brave-context-log4j2\5.6.1\brave-context-log4j2-5.6.1.jar;D:\maven-repo\io\zipkin\brave\brave-instrumentation-spring-web\5.6.1\brave-instrumentation-spring-web-5.6.1.jar;D:\maven-repo\io\zipkin\brave\brave-instrumentation-http\5.6.1\brave-instrumentation-http-5.6.1.jar;D:\maven-repo\io\zipkin\brave\brave-instrumentation-spring-rabbit\5.6.1\brave-instrumentation-spring-rabbit-5.6.1.jar;D:\maven-repo\io\zipkin\brave\brave-instrumentation-kafka-clients\5.6.1\brave-instrumentation-kafka-clients-5.6.1.jar;D:\maven-repo\io\zipkin\brave\brave-instrumentation-httpclient\5.6.1\brave-instrumentation-httpclient-5.6.1.jar;D:\maven-repo\io\zipkin\brave\brave-instrumentation-httpasyncclient\5.6.1\brave-instrumentation-httpasyncclient-5.6.1.jar;D:\maven-repo\io\zipkin\brave\brave-instrumentation-spring-webmvc\5.6.1\brave-instrumentation-spring-webmvc-5.6.1.jar;D:\maven-repo\io\zipkin\brave\brave-instrumentation-servlet\5.6.1\brave-instrumentation-servlet-5.6.1.jar;D:\maven-repo\io\zipkin\brave\brave-instrumentation-jms\5.6.1\brave-instrumentation-jms-5.6.1.jar;D:\maven-repo\org\springframework\cloud\spring-cloud-sleuth-zipkin\2.1.0.RELEASE\spring-cloud-sleuth-zipkin-2.1.0.RELEASE.jar;D:\maven-repo\org\springframework\spring-web\5.1.11.RELEASE\spring-web-5.1.11.RELEASE.jar;D:\maven-repo\io\zipkin\zipkin2\zipkin\2.12.0\zipkin-2.12.0.jar;D:\maven-repo\io\zipkin\reporter2\zipkin-reporter\2.7.14\zipkin-reporter-2.7.14.jar;D:\maven-repo\io\zipkin\reporter2\zipkin-sender-kafka11\2.7.14\zipkin-sender-kafka11-2.7.14.jar;D:\maven-repo\io\zipkin\reporter2\zipkin-sender-amqp-client\2.7.14\zipkin-sender-amqp-client-2.7.14.jar;D:\maven-repo\org\springframework\cloud\spring-cloud-starter-bus-amqp\2.1.0.RELEASE\spring-cloud-starter-bus-amqp-2.1.0.RELEASE.jar;D:\maven-repo\org\springframework\cloud\spring-cloud-starter-stream-rabbit\2.1.0.RELEASE\spring-cloud-starter-stream-rabbit-2.1.0.RELEASE.jar;D:\maven-repo\org\springframework\cloud\spring-cloud-stream-binder-rabbit\2.1.0.RELEASE\spring-cloud-stream-binder-rabbit-2.1.0.RELEASE.jar;D:\maven-repo\org\springframework\cloud\spring-cloud-stream-binder-rabbit-core\2.1.0.RELEASE\spring-cloud-stream-binder-rabbit-core-2.1.0.RELEASE.jar;D:\maven-repo\com\rabbitmq\http-client\2.1.0.RELEASE\http-client-2.1.0.RELEASE.jar;D:\maven-repo\org\springframework\boot\spring-boot-starter-amqp\2.1.10.RELEASE\spring-boot-starter-amqp-2.1.10.RELEASE.jar;D:\maven-repo\org\springframework\amqp\spring-rabbit\2.1.12.RELEASE\spring-rabbit-2.1.12.RELEASE.jar;D:\maven-repo\com\rabbitmq\amqp-client\5.4.3\amqp-client-5.4.3.jar;D:\maven-repo\org\springframework\amqp\spring-amqp\2.1.12.RELEASE\spring-amqp-2.1.12.RELEASE.jar;D:\maven-repo\org\springframework\integration\spring-integration-amqp\5.1.9.RELEASE\spring-integration-amqp-5.1.9.RELEASE.jar;D:\maven-repo\org\springframework\integration\spring-integration-jmx\5.1.9.RELEASE\spring-integration-jmx-5.1.9.RELEASE.jar;D:\maven-repo\org\springframework\cloud\spring-cloud-bus\2.1.0.RELEASE\spring-cloud-bus-2.1.0.RELEASE.jar;D:\maven-repo\org\springframework\cloud\spring-cloud-stream\2.1.0.RELEASE\spring-cloud-stream-2.1.0.RELEASE.jar;D:\maven-repo\org\springframework\boot\spring-boot-starter-validation\2.1.10.RELEASE\spring-boot-starter-validation-2.1.10.RELEASE.jar;D:\maven-repo\org\apache\tomcat\embed\tomcat-embed-el\9.0.27\tomcat-embed-el-9.0.27.jar;D:\maven-repo\org\hibernate\validator\hibernate-validator\6.0.18.Final\hibernate-validator-6.0.18.Final.jar;D:\maven-repo\javax\validation\validation-api\2.0.1.Final\validation-api-2.0.1.Final.jar;D:\maven-repo\org\jboss\logging\jboss-logging\3.3.3.Final\jboss-logging-3.3.3.Final.jar;D:\maven-repo\com\fasterxml\classmate\1.4.0\classmate-1.4.0.jar;D:\maven-repo\org\springframework\spring-messaging\5.1.11.RELEASE\spring-messaging-5.1.11.RELEASE.jar;D:\maven-repo\org\springframework\spring-tuple\1.0.0.RELEASE\spring-tuple-1.0.0.RELEASE.jar;D:\maven-repo\com\esotericsoftware\kryo-shaded\3.0.3\kryo-shaded-3.0.3.jar;D:\maven-repo\com\esotericsoftware\minlog\1.3.0\minlog-1.3.0.jar;D:\maven-repo\org\springframework\integration\spring-integration-tuple\1.0.0.RELEASE\spring-integration-tuple-1.0.0.RELEASE.jar;D:\maven-repo\org\springframework\retry\spring-retry\1.2.4.RELEASE\spring-retry-1.2.4.RELEASE.jar;D:\maven-repo\org\springframework\cloud\spring-cloud-function-context\2.0.0.RELEASE\spring-cloud-function-context-2.0.0.RELEASE.jar;D:\maven-repo\org\springframework\cloud\spring-cloud-function-core\2.0.0.RELEASE\spring-cloud-function-core-2.0.0.RELEASE.jar;D:\maven-repo\org\springframework\integration\spring-integration-core\5.1.9.RELEASE\spring-integration-core-5.1.9.RELEASE.jar;D:\maven-repo\org\springframework\spring-tx\5.1.11.RELEASE\spring-tx-5.1.11.RELEASE.jar;D:\maven-repo\io\projectreactor\reactor-core\3.2.12.RELEASE\reactor-core-3.2.12.RELEASE.jar;D:\maven-repo\org\reactivestreams\reactive-streams\1.0.3\reactive-streams-1.0.3.jar;D:\maven-repo\org\springframework\boot\spring-boot-devtools\2.1.10.RELEASE\spring-boot-devtools-2.1.10.RELEASE.jar;D:\maven-repo\org\springframework\boot\spring-boot\2.1.10.RELEASE\spring-boot-2.1.10.RELEASE.jar;D:\maven-repo\org\springframework\boot\spring-boot-autoconfigure\2.1.10.RELEASE\spring-boot-autoconfigure-2.1.10.RELEASE.jar;D:\maven-repo\org\projectlombok\lombok\1.18.10\lombok-1.18.10.jar;D:\maven-repo\org\slf4j\slf4j-api\1.7.29\slf4j-api-1.7.29.jar;D:\maven-repo\org\objenesis\objenesis\2.6\objenesis-2.6.jar;D:\maven-repo\org\springframework\spring-core\5.1.11.RELEASE\spring-core-5.1.11.RELEASE.jar;D:\maven-repo\org\springframework\spring-jcl\5.1.11.RELEASE\spring-jcl-5.1.11.RELEASE.jar com.haha.threadsafe.VolatileDemo
Thread1 线程终止

</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/to-be-bast/core/线程安全1.html" class="prev">
        线程安全
      </a></span> <span class="next"><a href="/to-be-bast/core/线程安全3.html">
        synchronized
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/to-be-bast/assets/js/app.c3e67182.js" defer></script><script src="/to-be-bast/assets/js/2.a97ad3d5.js" defer></script><script src="/to-be-bast/assets/js/35.8b547770.js" defer></script>
  </body>
</html>
